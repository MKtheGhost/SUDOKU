Imports System.IO
Imports System.Reflection.Emit
Imports System.Windows.Forms.VisualStyles.VisualStyleElement

Public Class Form1

    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        playerCB.Items.AddRange(File.ReadAllLines("..\..\playerName.txt"))
        NameLabel.ForeColor = Color.FromArgb(255, 114, 228)
        playerCB.ForeColor = Color.White



    End Sub

    Private Sub quitGame_Click(sender As Object, e As EventArgs) Handles quitGameBtn.Click
        'Me.Hide()
        QuitGameMsgBox.Show()
    End Sub

    Private Function estValide() As Boolean
        If Not String.IsNullOrWhiteSpace(newNameTBox.Text) Then
            Return True
        Else
            Return False
        End If

    End Function
    Private Sub addName_Click(sender As Object, e As EventArgs) Handles addNameBtn.Click

        If estValide() Then ' Verifie si le text es valide
            If Not Existent(newNameTBox.Text) Then 'verifie se le nickname existe ou pas
                Dim j As joeur
                j.nickName = newNameTBox.Text
                j.points = 0
                AjouterJoeur(j)
                My.Computer.FileSystem.WriteAllText("..\..\playerName.txt", Environment.NewLine + newNameTBox.Text, True)
                playerCB.Text = newNameTBox.Text
                playerCB.Items.Add(newNameTBox.Text)
            Else
                MsgBox("Personne deja existante")
            End If
        Else
            MsgBox("Erreur")
        End If
    End Sub

    Private Sub NewGameBtn_Click(sender As Object, e As EventArgs) Handles NewGameBtn.Click
        If playerCB.Text = "" Then
            NameLabel.ForeColor = Color.Red
            playerCB.ForeColor = Color.Red
            playerCB.Text = "Enter name"
        Else
            Form1_Load(sender, e)
            NewGame(playerCB)
            Me.Hide()
            Sudoku3X3.Show()
        End If
    End Sub

    Private Sub playerCB_SelectedIndexChanged(sender As Object, e As EventArgs) Handles playerCB.SelectedIndexChanged
        playerCB.ForeColor = Color.White

    End Sub
    Private Sub PlayerCB_TextChanged(sender As Object, e As EventArgs) Handles playerCB.TextChanged
        playerCB.DroppedDown = True
    End Sub


End Class